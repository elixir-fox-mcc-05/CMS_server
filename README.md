# CMS_server

## Authors

- **Yudha Arief Wijaya** - _Dev_ - [Github](https://github.com/yudhaaw96)
- Priambodo Kurniawan - Buddy Helper

## Client URL :

https://client-cms-ecommerce-yudhaaw96.firebaseapp.com/ (status : active)

## Server URL :

https://server-cms-ecommerce-yudhaaw96.herokuapp.com/ (status : active)

## SIGNUP USER

Create a new User

- ### URL

  /signup

- ### Method

  POST

- ### URL Params

  none

- ### Header Params

  none

- ### Data Params

  name = [string],<br>
  email = [string],<br>
  password = [string]

- ### Success Response

  - #### Code: 201
  - #### Content:

  ```
    {
        "CreatedUser": {
            "id": 1,
            "name": "admin",
            "email": "admin@admin.admin",
            "password": "$2a$10$ek0NmIkD7Zx4pL1O2pJJdeDLHC3AuDE2xQxdsZ9x2bnSQZVfbN606",
            "updatedAt": "2020-05-15T18:52:31.947Z",
            "createdAt": "2020-05-15T18:52:31.947Z",
            "role": "admin"
        }
    }
  ```

- ### Error Response:

  - #### Code: 400
    BAD REQUEST
  - #### Content:

  ```
    {
        "code": 400,
        "type": "BAD REQUEST",
        "message": [
            {
            "message": "Please insert name"
            },
            {
            "message": "Name at least 3 characters, max 15"
            },
            {
            "message": "Please insert correct email format"
            },
            {
            "message": "Please insert email"
            },
            {
            "message": "Please insert password"
            },
            {
            "message": "Password at least 3 characters, max 15"
            }
        ]
    }
  ```

## SIGNIN USER

Login as a User and generate Access Token that generated by jsonwebtoken

- ### URL

  /signin

- ### Method

  POST

- ### URL Params

  none

- ### Header Params

  none

- ### Data Params

  email = [string],<br>
  password = [string]

- ### Success Response

  - #### Code: 200
  - #### Content:

  ```
    {
        "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwiZW1haWwiOiJhZG1pbkBhZG1pbi5hZG1pbiIsInJvbGUiOiJhZG1pbiIsImlhdCI6MTU4OTU2ODc1Nn0.nkbzJ-0uTD3CD7-nw2Wc-2-gos1C9-eP-DRz705mPH4"
    }
  ```

- ### Error Response:

  - #### Code: 400
    BAD REQUEST
  - #### Content:

  ```
    {
        "code": 400,
        "type": "BAD REQUEST",
        "errors": "Opps!, invalid email / password"
    }
  ```

## CREATE PRODUCT

Create a new Product

- ### URL

  /products

- ### Method

  POST

- ### URL Params

  none

- ### Header Params

  - #### Headers:
    access_token :  Your Generated JSONWebToken (JWT) 

- ### Data Params

  - #### Body (form url encoded):
    name = [string],<br>
    image_url = [string],<br>
    price = [integer],<br>
    stock = [integer],<br>

- ### Success Response

  - #### Code: 201

  - #### Content:

  ```
    {
        "CreatedProduct": {
            "id": 12,
            "name": "gorengan",
            "image_url": "http://gambar.url",
            "price": 1111,
            "stock": 2222,
            "UserId": 1,
            "updatedAt": "2020-05-16T05:33:17.460Z",
            "createdAt": "2020-05-16T05:33:17.460Z"
        }
    }
  ```

- ### Error Response:

  - #### Code: 400
    BAD REQUEST
  - #### Content:

  ```
    {
        "code": 400,
        "type": "BAD REQUEST",
        "message": [
            {
            "message": "Please insert name"
            },
            {
            "message": "Please insert image url"
            },
            {
            "message": "Please insert valid url ex:(foo@bar.com)"
            },
            {
            "message": "Please insert price"
            },
            {
            "message": "Please insert stock"
            }
        ]
    }
  ```

  - #### Code: 401
    UNAUTHORIZED
  - #### Content:

  ```
    {
        "code": 401,
        "type": "UNAUTHORIZED",
        "message": "Please signin first!"
    }
  ```
  ```
    {
        "code": 401,
        "type": "UNAUTHORIZED",
        "message": "Sorry, not authorized, you are not an admin"
    }
  ```

# READ ALL PRODUCT

Show All Products

- ### URL

  /products

- ### Method

  GET

- ### URL Params

  none

- ### Header Params

  none

- ### Data Params

  none

- ### Success Response

  - #### Code: 200

  - #### Content:

  ```
    {
    "Products": [
            {
            "id": 1,
            "name": "gorengan",
            "image_url": "http://gambar.url",
            "price": 1111,
            "stock": 2222,
            "createdAt": "2020-05-15T21:38:41.642Z",
            "updatedAt": "2020-05-15T21:38:41.642Z",
            "UserId": 1
            },
            {
            "id": 2,
            "name": "gorengan",
            "image_url": "http://gambar.url",
            "price": 1111,
            "stock": 2222,
            "createdAt": "2020-05-15T21:55:43.203Z",
            "updatedAt": "2020-05-15T21:55:43.203Z",
            "UserId": 1
            }
        ]
    }
  ```

* ### Error Response:

  - #### Code: 500
    UNAUTHORIZED
  - #### Content:

  ```
    {
        "code": 500,
        "type": "INTERNAL SERVER ERROR",
        "message": * (any server error)
    }
  ```

# GET ONE PRODUCT

Show A Products

- ### URL

  /products/:id

- ### Method

  GET

- ### URL Params

  ### Required:

  id = [integer]

- ### Header Params

  - #### Headers:
    token :  Your Generated JSONWebToken (JWT) 

- ### Data Params

  none

- ### Success Response

  - #### Code: 200

  - #### Content:

  ```
    {
    "Product": 
            {
              "id": 1,
              "name": "gorengan",
              "image_url": "http://gambar.url",
              "price": 1111,
              "stock": 2222,
              "createdAt": "2020-05-15T21:38:41.642Z",
              "updatedAt": "2020-05-15T21:38:41.642Z",
              "UserId": 1
            }
  ```

* ### Error Response:

  - #### Code: 401
    UNAUTHORIZED
  - #### Content:

  ```
    {
        "code": 401,
        "type": "UNAUTHORIZED",
        "message": "Please signin first!"
    }
  ```
  
  - #### Code: 404
    NOT FOUND
  - #### Content:

  ```
    {
      "code": 404,
      "type": "NOT FOUND",
      "message": "Sorry, not found"
    }
  ```

## UPDATE PRODUCT

Update a Product

- ### URL

  /products/:id

- ### Method

  PUT

- ### URL Params

  ### Required:

  id = [integer]

- ### Header Params

  - #### Headers:
    token :  Your Generated JSONWebToken (JWT) 

- ### Data Params

  - #### Body (form url encoded):
    name = [string],<br>
    image_url = [string],<br>
    price = [integer],<br>
    stock = [integer],<br>

- ### Success Response

  - #### Code: 201
  - #### Content:

  ```
    {
    "UpdatedProduct": {
            "id": 1,
            "name": "gorengan EDIT",
            "image_url": "http://google.com",
            "price": 1000000,
            "stock": 2000000,
            "createdAt": "2020-05-15T21:38:41.642Z",
            "updatedAt": "2020-05-16T05:43:04.241Z",
            "UserId": 1
        }
    }
  ```

- ### Error Response:

  - #### Code: 401
    BAD REQUEST
  - #### Content:

  ```
    {
      "code": 400,
      "type": "BAD REQUEST",
      "message": [
        {
          "message": "Please insert name"
        },
        {
          "message": "Please insert image url"
        },
        {
          "message": "Please insert valid url ex:(foo@bar.com)"
        },
        {
          "message": "Please insert price"
        },
        {
          "message": "Please insert stock"
        }
      ]
    }
  ```

  - #### Code: 401
    UNAUTHORIZED
  - #### Content:

  ```
    {
        "code": 401,
        "type": "UNAUTHORIZED",
        "message": "Sorry, not authorized, you are not an admin"
    }
  ```

  - #### Code: 404
    Not Found
  - #### Content:

  ```
    {
        "code": 404,
        "type": "NOT FOUND",
        "errors": "Sorry, not found"
    }
  ```

## DELETE PRODUCT

Delete a Product

- ### URL

  /products/:id

- ### Method

  DELETE

- ### URL Params

  ### Required:

  id = [integer]

- ### Header Params

  - #### Headers:
    token :  Your Generated JSONWebToken (JWT) 

- ### Data Params

  none

- ### Success Response

  - #### Code: 200
  - #### Content:

  ```
    {
    "DeletedProduct": {
            "id": 1,
            "name": "gorengan EDIT",
            "image_url": "http://google.com",
            "price": 1000000,
            "stock": 2000000,
            "createdAt": "2020-05-15T21:38:41.642Z",
            "updatedAt": "2020-05-16T05:43:04.241Z",
            "UserId": 1
        }
    }
  ```

- ### Error Response:

  - #### Code: 401
    UNAUTHORIZED
  - #### Content:

  ```
    {
        "code": 401,
        "type": "UNAUTHORIZED",
        "message": "Sorry, not authorized, you are not an admin"
    }
  ```

  - #### Code: 404
    Not Found
  - #### Content:

  ```
    {
        "code": 404,
        "type": "NOT FOUND",
        "errors": "Sorry, not found"
    }
  ```

## ADD ITEAM TO CART

Add an item to cart

- ### URL

  /products

- ### Method

  POST

- ### URL Params

  none

- ### Header Params

  - #### Headers:
    access_token :  Your Generated JSONWebToken (JWT) 

- ### Data Params

  - #### Body (form url encoded):
    ProductId = [integer],<br>
    Quantity = [integer],<br>

- ### Success Response

  - #### Code: 201

  - #### Content:

  ```
    {
      "CreatedCartItem": {
        "id": 56,
        "UserId": 1,
        "ProductId": 4,
        "quantity": 2,
        "updatedAt": "2020-06-04T05:34:40.774Z",
        "createdAt": "2020-06-04T05:34:40.774Z",
        "status": false
      }
    }
  ```

- ### Error Response:

  - #### Code: 400
    BAD REQUEST
  - #### Content:

  ```
    {
        "code": 400,
        "type": "BAD REQUEST",
        "message": [
            {
            "message": "Please insert name"
            },
            {
            "message": "Please insert image url"
            },
            {
            "message": "Please insert valid url ex:(foo@bar.com)"
            },
            {
            "message": "Please insert price"
            },
            {
            "message": "Please insert stock"
            }
        ]
    }
  ```

  - #### Code: 401
    UNAUTHORIZED
  - #### Content:

  ```
    {
      "code": 400,
      "type": "BAD REQUEST",
      "message": "Already in cart, please update in cart page"
    }
  ```
  ```
    {
      "code": 400,
      "type": "BAD REQUEST",
      "message": "Sorry, product stock is less than request, please recheck stock and refresh browser"
    }
  ```
  ```
    {
      "code": 401,
      "type": "UNAUTHORIZED",
      "message": "Please signin first!"
    }
  ```

# READ ALL not paid CART

Show All Products in cart

- ### URL

  /cart/items

- ### Method

  GET

- ### URL Params

  none

- ### Header Params

  - #### Headers:
    access_token :  Your Generated JSONWebToken (JWT) 

- ### Data Params

  none

- ### Success Response

  - #### Code: 200

  - #### Content:

  ```
    {
      "CartNotYetPaid": [
        {
          "id": 56,
          "UserId": 1,
          "ProductId": 4,
          "quantity": 2,
          "status": false,
          "createdAt": "2020-06-04T05:34:40.774Z",
          "updatedAt": "2020-06-04T05:34:40.774Z",
          "Product": {
            "id": 4,
            "name": "x EXIT",
            "image_url": "http://image.url",
            "price": 1000000,
            "stock": 80,
            "UserId": 1,
            "createdAt": "2020-06-03T17:59:29.082Z",
            "updatedAt": "2020-06-04T05:34:32.193Z"
          }
        }
      ]
    }
  ```

* ### Error Response:

  - #### Code: 401
    UNAUTHORIZED
  - #### Content:

  ```
    {
      "code": 401,
      "type": "UNAUTHORIZED",
      "message": "Please signin first!"
    }
  ```

# READ ALL paid CART (purchase history)

Show All Products in purchase history (paid cart)

- ### URL

  {{host}}/cart/items/paid

- ### Method

  GET

- ### URL Params

  none

- ### Header Params

  - #### Headers:
    access_token :  Your Generated JSONWebToken (JWT) 

- ### Data Params

  none

- ### Success Response

  - #### Code: 200

  - #### Content:

  ```
    {
      "CartPaid": [
        {
          "id": 1,
          "UserId": 1,
          "ProductId": 1,
          "quantity": 1,
          "status": true,
          "createdAt": "2020-06-03T17:59:51.794Z",
          "updatedAt": "2020-06-03T19:02:22.160Z",
          "Product": {
            "id": 1,
            "name": "xHanya TesX",
            "image_url": "http://hanya.tes",
            "price": 9999,
            "stock": 0,
            "UserId": 1,
            "createdAt": "2020-06-03T17:59:27.126Z",
            "updatedAt": "2020-06-03T19:23:18.363Z"
          }
        },
        {
          "id": 2,
          "UserId": 1,
          "ProductId": 1,
          "quantity": 1,
          "status": true,
          "createdAt": "2020-06-03T19:13:30.567Z",
          "updatedAt": "2020-06-03T19:13:40.112Z",
          "Product": {
            "id": 1,
            "name": "xHanya TesX",
            "image_url": "http://hanya.tes",
            "price": 9999,
            "stock": 0,
            "UserId": 1,
            "createdAt": "2020-06-03T17:59:27.126Z",
            "updatedAt": "2020-06-03T19:23:18.363Z"
          }
        },
        {
          "id": 3,
          "UserId": 1,
          "ProductId": 1,
          "quantity": 1,
          "status": true,
          "createdAt": "2020-06-03T19:17:43.308Z",
          "updatedAt": "2020-06-03T19:17:52.562Z",
          "Product": {
            "id": 1,
            "name": "xHanya TesX",
            "image_url": "http://hanya.tes",
            "price": 9999,
            "stock": 0,
            "UserId": 1,
            "createdAt": "2020-06-03T17:59:27.126Z",
            "updatedAt": "2020-06-03T19:23:18.363Z"
          }
        }
      ]
    }
  ```

* ### Error Response:

  - #### Code: 401
    UNAUTHORIZED
  - #### Content:

  ```
    {
      "code": 401,
      "type": "UNAUTHORIZED",
      "message": "Please signin first!"
    }
  ```
## UPDATE CART ITEM

Update a Product in Cart

- ### URL

  /cart/items/edit/:id

- ### Method

  PUT

- ### URL Params

  ### Required:

  id = [integer]

- ### Header Params

  - #### Headers:
    token :  Your Generated JSONWebToken (JWT) 

- ### Data Params

  - #### Body (form url encoded):
    quantity = [integer],<br>

- ### Success Response

  - #### Code: 200
  - #### Content:

  ```
    {
      "UpdateItem": "Success update quantity"
    }
  ```

- ### Error Response:

  - #### Code: 401
    UNAUTHORIZED
  - #### Content:

  ```
    {
      "code": 401,
      "type": "UNAUTHORIZED",
      "message": "Please signin first!"
    }
  ```

  - #### Code: 404
    Not Found
  - #### Content:

  ```
    {
      "code": 404,
      "type": "NOT FOUND",
      "errors": "Sorry, not found"
    }
  ```

## DELETE an ITEM in CART

Delete a Product in Cart

- ### URL

  /cart/items/:id

- ### Method

  DELETE

- ### URL Params

  ### Required:

  id = [integer]

- ### Header Params

  - #### Headers:
    token :  Your Generated JSONWebToken (JWT) 

- ### Data Params

  none

- ### Success Response

  - #### Code: 200
  - #### Content:

  ```
    {
      "DeletedItem": {
        "id": 57,
        "UserId": 1,
        "ProductId": 5,
        "quantity": 4,
        "status": false,
        "createdAt": "2020-06-04T05:55:56.177Z",
        "updatedAt": "2020-06-04T05:55:56.177Z"
      }
    }
  ```

- ### Error Response:

  - #### Code: 401
    UNAUTHORIZED
  - #### Content:

  ```
    {
      "code": 401,
      "type": "UNAUTHORIZED",
      "message": "Please signin first!"
    }
  ```

  - #### Code: 404
    Not Found
  - #### Content:

  ```
    {
      "code": 404,
      "type": "NOT FOUND",
      "errors": "Sorry, not found"
    }
  ```

## CART CHECKOUT

Update all item's status in cart to true as paid

- ### URL

  /cart/checkout

- ### Method

  PUT

- ### URL Params

  ### Required:

  id = [integer]

- ### Header Params

  - #### Headers:
    token :  Your Generated JSONWebToken (JWT) 

- ### Data Params

  none

- ### Success Response

  - #### Code: 200
  - #### Content:

  ```
    {
      "CheckoutItems": "Success checkout, please check purchase history"
    }
  ```

- ### Error Response:

  - #### Code: 400
    BAD REQUEST
  - #### Content:

  ```
    {
      "code": 400,
      "type": "BAD REQUEST",
      "message": "Nothing in Cart"
    }
  ```
